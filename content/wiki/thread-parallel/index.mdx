---
title   : '하드웨어 스레드와 소프트웨어 스레드' 
slug  : '/thread'
layout  : wiki 
excerpt : 
date    : 2020-07-19 15:51:58 +0900
updated : 2020-07-19 17:28:18
tags    : 
  - OS
---

### 서론
[CompletableFuture 의 비동기 처리](https://juneyr.dev/modern-java-4)를 공부하다가 비동기 작업을 다시 merge하는 작업, 즉 thenCompose 와 thenCombine 등에서 두 가지 버전을 지원한다는 사실을 알게 되었다. 

- thenCompose 는 넘겨받은 함수 작업을 현재와 같은 thread에서 실행한다. 

- thenComposeAsync 는 넘겨받은 함수 작업을 새로운 thread에서 실행한다. 
  
이런 식으로 thread 와 관련된 개념을 정리하다보니 궁금해졌다. 

> 자바에서 말하는 스레드는 몇개씩이나 있는데, 1코어에 1스레드만 있다는 건 무슨 말일까? 

## 그건 바로 하드웨어 스레드와 소프트웨어 스레드의 차이다

조금 검색해보니, 바로 하드웨어 스레드와 소프트웨어 스레드의 차이라는 것을 알게되었다 💪  

하드웨어 스레드를 설명하려면 CPU 코어부터 설명해야하니까 , 천천히 CPU 부터 다시 짚어보도록 하자. 

### CPU, 코어, 하드웨어 스레드
CPU 는 Central Processing Unit 이라는 말처럼, 컴퓨터의 뇌 역할을 하는 하드웨어다. CPU 안에 실제로 계산을 하는 건 **코어 core** 인데, 하나의 CPU 에 하나만 있는건 아니다. 실제로 CPU 는 2코어(듀얼코어), 4코어(쿼드코어), 8코어(옥타코어) 를 지원하는 것이 일반적이다. 코어는 **물리적인** 계산의 유닛이다. 하드웨어 스레드는 os가 스케쥴 해줄 수 있는 최소 단위의 일 (=instruction의 모음) 이다. 일반적으로 1코어는 1스레드를 지원하고 있다. 그런데 1스레드로 1코어의 성능을 모두 사용하지 못하는 일이 자주 생기자, 하이퍼스레딩이라는 개념을 도입해서 1코어:n개의 스레드를 지원할 수 있게 되었다. 와우 🧘‍♀️  ... 

그러니까 2코어인 경우 4스레드를 지원하는 경우도 있다는 뜻이다. 여기서의 하드웨어 스레드 갯수는 보통 **동시에 실행 가능한 스레드 갯수** 를 의미한다. 

### 소프트웨어 스레드 

그러나 자바프로그램에서는 `Executors.newFixedThreadPool(100)` 이라는 식으로 스레드 갯수를 훨씬 많이 설정할 수 있다. 이 스레드는 소프트웨어 스레드를 의미한다. 


### 참고 

https://jista.tistory.com/98
https://kldp.org/node/154708




### 참고 

https://kldp.org/node/154708 
https://velog.io/@dvmflstm/CPU-%EC%8A%A4%EB%A0%88%EB%93%9C-%EC%86%8C%ED%94%84%ED%8A%B8%EC%9B%A8%EC%96%B4-%EC%8A%A4%EB%A0%88%EB%93%9C
