---
slug: "/2019-06-12/design-pattern-observer"
updated: 2020-03-09 14:21
title: ì˜µì €ë²„ íŒ¨í„´ ğŸŒš
date: 2019-06-12
tags: 
    - DesignPattern
    - Java
---

HEAD FIRST DESIGN PATTERN ì„ ì •ë¦¬í•©ë‹ˆë‹¤.

[01 ìŠ¤íŠ¸ë ˆí‹°ì§€ íŒ¨í„´ ë³´ê¸°](https://junebuug.github.io/2019-04-17/design-pattern-strategy)

# 02 ì˜µì €ë²„ íŒ¨í„´

## WeatherData ì˜ˆì œ 

ê¸°ìƒì •ë³´ë¥¼ ì•Œë ¤ì£¼ëŠ” Weather Data ê°ì²´ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë””ìŠ¤í”Œë ˆì´ ì¥ë¹„ë¥¼ ë§Œë“¤ì–´ë´…ë‹ˆë‹¤. 

WeatherDataëŠ” ê¸°ìƒìŠ¤í…Œì´ì…˜ì—ì„œ ë°›ì•„ì˜¤ëŠ” ì˜¨ë„, ìŠµë„, ì••ë ¥ ì •ë³´ê°€ ìˆê³  - ì´ë¥¼ í‘œì‹œí•˜ê¸°ë§Œ í•˜ë©´ ë©ë‹ˆë‹¤. 

```java 

public class WeatherData(){
    getTemperature(); 
    getHumidity(); 
    getPressure();
    measurementsChanged(); // ê´€ì¸¡ê°’ì´ ë³€ê²½ë  ë–„ë§ˆë‹¤ ì•Œë ¤ì£¼ëŠ” ë©”ì†Œë“œ
}

```

### ì¡°ê±´
* ë°ì´í„°ê°€ ë³€í•  ë•Œë§ˆë‹¤ `measurementsChanged` ë©”ì†Œë“œê°€ ë¶ˆë¦¬ê³ , ìš°ë¦¬ëŠ” ì´ë•Œë§ˆë‹¤ ë””ìŠ¤í”Œë ˆì´ë¥¼ ì—…ë°ì´íŠ¸í•´ì•¼í•©ë‹ˆë‹¤. 
* ì‹œìŠ¤í…œì´ í™•ì¥ ê°€ëŠ¥í•´ì•¼í•©ë‹ˆë‹¤. 


### ì´ë ‡ê²Œ ë§Œë“¤ë©´ ì–´ë–¨ê¹Œìš”..? (ë‚˜ìœ ì˜ˆ)

```java

public class WeatherData{
    // ë³€ìˆ˜ ì„ ì–¸ 
    public void measurementsChanged(){
        float temp = getTemperature; 
        // humidity, pressure ë„ ê°€ì ¸ì˜¤ê¸° 

        currentConditionDisplay.update(temp, humidity, pressure);
        // ë‹¤ë¥¸ display ë“¤ë„ ë˜‘ê°™ì´ ì—…ë°ì´íŠ¸ .
    }
}
 
```
ì´ ì½”ë“œëŠ”.. 

* êµ¬ì²´ì ì¸ êµ¬í˜„ì— ë§ì¶° ì½”ë”©í•´ì„œ í”„ë¡œê·¸ë¨ì„ ê³ ì¹˜ì§€ ì•Šìœ¼ë©´ ë‹¤ë¥¸ ë””ìŠ¤í”Œë ˆì´ë¥¼ ë„£ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.
* display.update ë¶€ë¶„ì´ ë°”ë€”ìˆ˜ ìˆì–´ ìº¡ìŠí™”í•´ì•¼í•©ë‹ˆë‹¤.


## ì˜µì €ë²„ íŒ¨í„´ 

ì˜µì €ë²„ íŒ¨í„´ì€ ì‹ ë¬¸ êµ¬ë…ê³¼ ê°™ì€ ë§¤ì»¤ë‹ˆì¦˜ì…ë‹ˆë‹¤. 
í¬ê²Œ ì£¼ì œ Subject ê°ì²´ì™€ ì˜µì €ë²„ Observer ê°ì²´ê°€ ì¡´ì¬í•˜ëŠ”ë°ìš”. 
ë‹¤ìŒê³¼ ê°™ì€ íë¦„ì„ ë”°ë¼ê°‘ë‹ˆë‹¤. 

1. ì£¼ì œ ê°ì²´ì—ì„œ ì¼ë¶€ ë°ì´í„°ë¥¼ ê´€ë¦¬í•©ë‹ˆë‹¤. 
2. ì˜µì €ë²„ ê°ì²´ë“¤ì€ ì£¼ì œ ê°ì²´ë“¤ì„ **êµ¬ë…**í•˜ê³  ìˆìœ¼ë©°, ì£¼ì œì˜ ë°ì´í„°ê°€ ë‹¬ë¼ì§€ë©´ ê°±ì‹  ë‚´ìš©ì„ ì „ë‹¬ ë°›ìŠµë‹ˆë‹¤. 
3. ì£¼ì œì˜ ë°ì´í„°ê°€ **ë‹¬ë¼ì§€ë©´** ì˜µì €ë²„ì—ê²Œ ê·¸ ì†Œì‹ì´ ì „í•´ì§‘ë‹ˆë‹¤. 
4. ì˜µì €ë²„ê°€ ì•„ë‹Œ ê°ì²´ëŠ” ì£¼ì œ ê°ì²´ì˜ ë°ì´í„°ê°€ ë°”ë€Œì–´ë„ ì•„ë¬´ëŸ° ì—°ë½ì„ ëª»ë°›ìŠµë‹ˆë‹¤. 


> ì˜µì €ë²„ íŒ¨í„´ì—ì„œëŠ” í•œ ê°ì²´ì˜ ìƒíƒœê°€ ë°”ë€Œë©´, ê·¸ ê°ì²´ì— ì˜ì¡´í•˜ëŠ” ë‹¤ë¥¸ ê°ì²´ë“¤ì—ê²Œ ì—°ë½ì´ ê°€ê³ , ìë™ìœ¼ë¡œ ë‚´ìš©ì´ ê°±ì‹ ë˜ëŠ” ë°©ì‹ìœ¼ë¡œ ì¼ëŒ€ë‹¤ ì˜ì¡´ì„±ì„ ì •ì˜í•©ë‹ˆë‹¤. 


![](../img/2019-06-12/observer.png)


### ì˜µì €ë²„ í´ë˜ìŠ¤ ë‹¤ì´ì–´ê·¸ë¨ 

![](../img/2019-06-12/observerclassdiagram.png)

ì—¬ê¸°ì„œ ë°ì´í„°ì˜ ì£¼ì¸ì€ ì£¼ì œì…ë‹ˆë‹¤. ì˜µì €ë²„ëŠ” ì£¼ì œì˜ ë°ì´í„°ê°€ ë°”ë€Œê¸°ë¥¼ ê¸°ë‹¤ë¦¬ê¸°ë•Œë¬¸ì— 
**ì£¼ì œì— ì˜ì¡´ì„±ì„ ê°€ì§„ë‹¤** ë¼ê³  ë§í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### ì˜µì €ë²„ íŒ¨í„´ì—ì„œëŠ” ì£¼ì œì™€ ì˜µì €ë²„ê°€ ëŠìŠ¨í•˜ê²Œ ê²°í•© 

> ëŠìŠ¨í•˜ê²Œ ê²°í•©í•œë‹¤ëŠ” ë§ì€ ë‘˜ì´ ìƒí˜¸ì‘ìš©ì„ í•˜ê¸´í•˜ì§€ë§Œ ì„œë¡œì— ëŒ€í•´ì„œ ì˜ ëª¨ë¥¸ë‹¤ 

ëŠ” ê²ƒì„ ì˜ë¯¸í•©ë‹ˆë‹¤. 

* ì£¼ì œê°€ ì˜µì €ë²„ì— ëŒ€í•´ì„œ ì•„ëŠ” ê²ƒì€ íŠ¹ì • ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•œë‹¤ëŠ” ê²ƒ ë¿ì…ë‹ˆë‹¤.
* ì˜µì €ë²„ëŠ” ì–¸ì œë“ ì§€ ìƒˆë¡œ ì¶”ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
* ìƒˆë¡œìš´ ì˜µì €ë²„ë¥¼ ì¶”ê°€í•´ë„ ì£¼ì œë¥¼ ë³€ê²½í•  í•„ìš”ê°€ ì—†ìŠµë‹ˆë‹¤.
* ì£¼ì œì™€ ì˜µì €ë²„ëŠ” ì„œë¡œ ë…ë¦½ì ìœ¼ë¡œ ì¬ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. 
* ì£¼ì œì™€ ì˜µì €ë²„ê°€ ë°”ë€Œë”ë¼ë„ ì„œë¡œì—ê²Œ ì˜í–¥ì„ ë¯¸ì¹˜ì§€ëŠ” ì•ŠìŠµë‹ˆë‹¤. 

ëŠìŠ¨í•œ ê²°í•©(loose coupling) ì„ ì‚¬ìš©í•˜ë©´ ë³€ê²½ ì‚¬í•­ì´ ìƒê²¨ë„ 
ìœ ì—°í•˜ê²Œ ì²˜ë¦¬í•  ìˆ˜ ìˆëŠ” ê°ì²´ì§€í–¥ ì‹œìŠ¤í…œì„ êµ¬í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. 



## ì˜µì €ë²„ë¡œ WeatherData ì˜ˆì œ ë¥¼ êµ¬í˜„í•´ë´…ì‹œë‹¤. 

ì˜µì €ë²„ íŒ¨í„´ì„ ìœ„ ì˜ˆì œì—ì„œ êµ¬í˜„í•´ë´…ì‹œë‹¤. 
WeatherDataëŠ” ë°”ë€ŒëŠ” ì •ë³´ë¥¼ ë‹´ê³  ìˆëŠ” ì£¼ì œê°ì²´ë¡œ, 
DisplayëŠ” ì´ë¥¼ êµ¬ë…í•˜ëŠ” ì˜µì €ë²„ ê°ì²´ë¡œ ë§¤í•‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. 

```java 

public interface Subject {
    public void registerObserver(Observer o);
    public void removeObserver(Observer o);
    public void notifyObservers();
}


public interface Observer {
    public void update(float temp, float humidity, float pressure);
}

public interface Display{
    public void display();
}

// êµ¬ì²´ì ì¸ display ë“¤ì€ Observerì™€ display ë‘˜ë‹¤ë¥¼ êµ¬í˜„í•©ë‹ˆë‹¤. 

```

ì‹¤ì œ WeatherDataë¥¼ í•œë²ˆ ë³´ê² ìŠµë‹ˆë‹¤.

```java 
public class WeatherData implements Subject{

    // ë³€ìˆ˜, ìƒì„±ìë“¤ ...
    private List<Observers> observers; 

    public void registerObserver(Observer o){
        observers.add(o);
    }
    
    public void removeObserver(Observer o){
        int i = observers.indexOf(o);
        if (i >= 0){
            observers.remove(i);
        }
    }

    public void notifyObservers(){
        for(Observer o : observers){
            o.update(temp, humidity, pressure);
        }
    }

    public void mearsuremenetChanged(){
        notifyObservers();
    }
    // getter, setter
} 

```

ìˆ˜ì¹˜ê°€ ë³€í™”í•  ë•Œë§ˆë‹¤ Observerë“¤ì—ê²Œ notifyí•©ë‹ˆë‹¤. 


ê·¸ëŸ¬ë©´ Observer ì—­í• ì¸ Displayë¥¼ ë³´ê² ìŠµë‹ˆë‹¤. 

```java 
@Slf4j
public class ADisplay implements Observer, Display{

    // ë³€ìˆ˜ 
    private Subject weatherData; 

    public ADisplay(Subject weatherData) {
        this.weatherData = weatherData; 
        // weatherDataë¥¼ ì£¼ì…ë°›ìŒ 
        weatherData.registerObserver(this);
    }

    public void update(float temp, float humidity, float pressure){
        this.temp = temp;
        this.humidity = humidity; 
        display();
    }

    public void display(){
        log.info("Current conditions: {}, {}", temp, humidity);
    }
}

```

interfaceì—ì„œ ìƒì†ë°›ì€ update, display ë¥¼ ê°ê° êµ¬í˜„í•˜ê³  ìˆìŠµë‹ˆë‹¤. 


## ì¶”ê°€ë¡œ - Observer ì™€ publish-sub íŒ¨í„´ì€ ë­ê°€ ë‹¤ë¥¼ê¹Œ? 

[ì°¸ê³ ](https://jistol.github.io/software%20engineering/2018/04/11/observer-pubsub-pattern/)

Publish - Subscribe êµ¬ì¡°ëŠ” Observerì™€ ë¹„ìŠ·í•˜ì§€ë§Œ ì°¨ì´ì ì´ ìˆìŠµë‹ˆë‹¤. 

ë°”ë¡œ ì¤‘ê°„ì— **ë©”ì‹œì§€ ë¸Œë¡œì»¤** ê°€ ì¡´ì¬í•œë‹¤ëŠ” ê²ƒì¸ë°ìš”. 
ì´ë ‡ê²Œ í•´ì„œ Pub-Subêµ¬ì¡°ì—ì„œëŠ” ì•„ì˜ˆ ì„œë¡œë¥¼ ì¸ì§€í•˜ì§€ ëª»í•˜ê²Œ ë©ë‹ˆë‹¤. 
ë‘˜ë‹¤ ì¤‘ê°„ì— ìˆëŠ” ë¸Œë¡œì»¤ë§Œ ë°”ë¼ë³´ê²Œ ë©ë‹ˆë‹¤. 

* ë¸Œë¡œì»¤ê°€ message queueë¥¼ ë§ì´ ì“°ê¸°ë•Œë¬¸ì—, asyncë°©ì‹ì„ (queueì—ì„œ ë‚˜ì˜¬ ë•Œ subì—ê²Œ ì „ë‹¬)
* observerë³´ë‹¤ ë” loose í•œ coupling


-

ì˜¤ëŠ˜ì€ 2ì¥ ObserveríŒ¨í„´ì— ëŒ€í•´ì„œ ì •ë¦¬í–ˆëŠ”ë°ìš”.

ë„ì›€ì´ ë˜ì…¨ìœ¼ë©´ ì¢‹ê² ìŠµë‹ˆë‹¤. 